(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{160:function(t,e,n){},162:function(t,e,n){},164:function(t,e,n){},184:function(t,e,n){},185:function(t,e,n){"use strict";n.r(e);var a,r=n(2),c=n.n(r),o=n(46),i=n.n(o),l=(n(160),n(6)),s={pds:null,pdFilter:{ntRange:[],cnys:[],cats:[]},pdCurFilter:{ntRange:[],cny:"",cat:""}},u=Object(r.createContext)({state:s,dispatch:function(){return null}}),d=n(1);!function(t){t[t.SET_ALL_PD=0]="SET_ALL_PD",t[t.SET_FILTER_START_NOTICE_DATE=1]="SET_FILTER_START_NOTICE_DATE",t[t.SET_FILTER_END_NOTICE_DATE=2]="SET_FILTER_END_NOTICE_DATE",t[t.SET_FILTER_COUNTRY=3]="SET_FILTER_COUNTRY",t[t.SET_FILTER_CATEGORY=4]="SET_FILTER_CATEGORY"}(a||(a={}));var p=function(t,e){switch(e.type){case a.SET_ALL_PD:return Object(d.a)(Object(d.a)({},t),e.data);case a.SET_FILTER_START_NOTICE_DATE:return Object(d.a)(Object(d.a)({},t),{pdCurFilter:Object(d.a)(Object(d.a)({},t.pdCurFilter),{ntRange:[e.data,t.pdCurFilter.ntRange[1]]})});case a.SET_FILTER_END_NOTICE_DATE:return Object(d.a)(Object(d.a)({},t),{pdCurFilter:Object(d.a)(Object(d.a)({},t.pdCurFilter),{ntRange:[t.pdCurFilter.ntRange[0],e.data]})});case a.SET_FILTER_COUNTRY:return Object(d.a)(Object(d.a)({},t),{pdCurFilter:Object(d.a)(Object(d.a)({},t.pdCurFilter),{cny:e.data})});case a.SET_FILTER_CATEGORY:return Object(d.a)(Object(d.a)({},t),{pdCurFilter:Object(d.a)(Object(d.a)({},t.pdCurFilter),{cat:e.data})});default:return t}},f=n(5),j=n.n(f),T=n(47),O=function(t){var e={ntRange:[],cnys:[],cats:[]},n={ntRange:[],cny:"",cat:""},a=t.map((function(t){return{nt:new Date("".concat(t.nt,"T00:00:00")),cny:t.cny,cat:t.cat,pd:t.pd}}));return a.sort((function(t,e){return t.nt.getTime()-e.nt.getTime()})),e.ntRange=[a[0].nt,a[a.length-1].nt],e.cnys=Array.from(new Set(t.map((function(t){return t.cny})))),e.cats=Array.from(new Set(t.map((function(t){return t.cat})))),n.ntRange=[a[0].nt,a[a.length-1].nt],n.cny=e.cnys[0],n.cat=e.cats[0],{pds:a,pdFilter:e,pdCurFilter:n}},b=(n(162),n(0)),h=function(){return Object(b.jsxs)("div",{className:"lds-facebook",children:[Object(b.jsx)("div",{}),Object(b.jsx)("div",{}),Object(b.jsx)("div",{})]})},g=function(t){return[t.getFullYear(),("0"+(t.getMonth()+1)).slice(-2),("0"+t.getDate()).slice(-2)].join("-")},v=864e5,y=2592e6,E=31104e6,m=function t(e,n){var a=n?" Day ":"D",r=n?" Month ":"M",c=n?" Year ":"Y";if(e<y)return"".concat(Math.floor(e/v)).concat(a);if(e<E){var o=Math.floor(e/y),i=e-o*y;return"".concat(o).concat(r).concat(t(i,n))}var l=Math.floor(e/E),s=e-l*E;return"".concat(l).concat(c).concat(t(s,n))},_=function(t){var e=g(t.nt),n="",a="";return"C"===t.note?(n="Priority Date: Current",a="No need to wait"):"U"===t.note?(n="Priority Date: Unavailable",a="Please wait..."):(n="Priority Date: ".concat(g(t.pd)),a="You need to wait ".concat(m(t.val,!0))),[e,n,a]},x=(n(164),function(){var t=Object(r.useContext)(u),e=t.state,n=t.dispatch,c=Object(l.a)(e.pdFilter.ntRange,2),o=c[0],i=c[1],s=e.pdFilter,d=s.cnys,p=s.cats;return Object(b.jsxs)("div",{className:"filter-container",children:[Object(b.jsxs)("div",{className:"filter-control",children:[Object(b.jsx)("label",{htmlFor:"date-from",children:"From:"}),Object(b.jsx)("input",{type:"date",id:"date-from",defaultValue:g(new Date(o)),min:g(new Date(o)),max:g(new Date(i)),onChange:function(t){return n({type:a.SET_FILTER_START_NOTICE_DATE,data:new Date("".concat(t.target.value,"T00:00:00")).getTime()})}}),Object(b.jsx)("label",{htmlFor:"date-to",children:"To:"}),Object(b.jsx)("input",{type:"date",id:"date-to",defaultValue:g(new Date(i)),min:g(new Date(o)),max:g(new Date(i)),onChange:function(t){return n({type:a.SET_FILTER_END_NOTICE_DATE,data:new Date("".concat(t.target.value,"T00:00:00")).getTime()})}})]}),Object(b.jsxs)("div",{className:"filter-control",children:[Object(b.jsx)("label",{htmlFor:"pd-country",children:"Region:"}),Object(b.jsx)("select",{id:"pd-country",onChange:function(t){return n({type:a.SET_FILTER_COUNTRY,data:t.target.value})},children:d.map((function(t){return Object(b.jsx)("option",{value:t,children:t},"pd-country-".concat(t))}))})]}),Object(b.jsxs)("div",{className:"filter-control",children:[Object(b.jsx)("label",{htmlFor:"pd-category",children:"Category:"}),Object(b.jsx)("select",{id:"pd-category",onChange:function(t){return n({type:a.SET_FILTER_CATEGORY,data:t.target.value})},children:p.map((function(t){return Object(b.jsx)("option",{value:t,children:t},"pd-category-".concat(t))}))})]})]})}),F=n(4),C=function(){var t=Object(r.useContext)(u).state,e=Object(r.useRef)(null);return Object(r.useEffect)((function(){if(e.current&&t.pds){var n=e.current,a=.9*window.innerWidth,r=.8*window.innerHeight,c=100,o=10,i=30,l=70;n.style.width="".concat(a,"px"),n.style.height="".concat(r,"px"),n.style.backgroundColor="slategrey";var s=a-l-o,u=r-c-i,d=function(t,e){var n=e.ntRange,a=e.cny,r=e.cat;return t.filter((function(t){return t.nt<=n[1]&&t.nt>=n[0]&&t.cny===a&&t.cat===r}))}(t.pds,t.pdCurFilter);console.log(d,t.pdCurFilter);var p=F.g().domain(t.pdCurFilter.ntRange).range([0,s]),f=d.map((function(t){var e={val:1e3,note:"",nt:t.nt,pd:new Date};if("C"===t.pd||"U"===t.pd)e.note=t.pd;else{var n=new Date("".concat(t.pd,"T00:00:00"));isNaN(n.getTime())?e.note="NAN":(e.val=e.nt.getTime()-n.getTime(),e.pd=n)}return e})),j=F.f().domain([0,F.e(f,(function(t){return t.val}))]).range([u,0]),T=F.h(e.current);T.selectAll("*").remove();var O=F.c((function(t){return t.nt})).left,b=(T.append("rect").style("fill","none").style("pointer-events","all").attr("class","pd-chart-area").attr("width",s).attr("height",u).attr("transform","translate(".concat(l,",").concat(c,")")).on("mousemove",(function(t){var e=t.offsetX-l,n=p.invert(e),a=O(f,n,1),r=f[a];if(r){y.attr("cx",p(r.nt)+l).attr("cy",j(r.val)+c);var o=_(r);E.selectAll(".sub-text").data(o).text((function(t){return t}))}})).on("mouseout",(function(){y.style("opacity",0),E.style("opacity",0)})).on("mouseover",(function(){y.style("opacity",1),E.style("opacity",1)})),T.append("g").attr("class","pd-chart").attr("transform","translate(".concat(l,",").concat(c,")"))),h=F.a(p).ticks(F.j).tickFormat(F.i("%Y")),g=(T.append("g").attr("transform","translate(".concat(l,", ").concat(u+c,")")).call(h),F.b(j).tickFormat((function(t){return m(t.valueOf(),!1)}))),v=(T.append("g").call(g).attr("transform","translate(".concat(l,", ").concat(c,")")),F.d().x((function(t){return p(t.nt)})).y((function(t){return j(t.val)})));b.append("path").attr("stroke-width",1.5).attr("fill","none").attr("stroke","bisque").attr("d",v(f));for(var y=T.append("g").append("circle").style("fill","red").attr("stroke","red").attr("r",3).style("opacity",0),E=T.append("g").append("text").style("opacity",0).style("fill","white").attr("x",l+20).attr("y",c+20).attr("text-anchor","left").attr("alignment-baseline","middle"),x=0;x<3;x++)E.append("tspan").attr("class","sub-text").attr("x",l+20).attr("dy","1em");var C=_(f.slice(-1)[0]);T.append("g").append("text").style("fill","white").style("font-size","3em").attr("x",150).attr("y",60).text("From the latest data, ".concat(C[1]))}}),[e,t.pdCurFilter,t.pds,t.pdFilter]),Object(b.jsx)("div",{children:Object(b.jsx)("svg",{ref:e,className:"svg-container"})})},R=function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)(x,{}),Object(b.jsx)(C,{})]})},w=n(48),D=n.n(w),N=function(){var t=Object(r.useContext)(u),e=t.state,n=t.dispatch;return Object(r.useEffect)((function(){(function(){var t=Object(T.a)(j.a.mark((function t(){var e;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.a.get("/api/all_pd");case 2:200===(e=t.sent).status&&e.data&&n({type:a.SET_ALL_PD,data:Object(d.a)({},O(e.data))});case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[n]),Object(b.jsx)("div",{children:null===e.pds?Object(b.jsx)(h,{}):Object(b.jsx)(R,{})})};n(184);var S=function(){var t=Object(r.useReducer)(p,s),e=Object(l.a)(t,2),n=e[0],a=e[1];return Object(b.jsx)(u.Provider,{value:{state:n,dispatch:a},children:Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(N,{})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var A=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,186)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),a(t),r(t),c(t),o(t)}))};i.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(S,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()})).catch((function(t){console.error(t.message)})),A()}},[[185,1,2]]]);
//# sourceMappingURL=main.db602eb5.chunk.js.map